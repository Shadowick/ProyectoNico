<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Formulario de Registro</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css" />
  <style>
    .resultado {
      margin-top: 1rem;
      font-weight: bold;
      font-size: 1.1rem;
    }
    .pregunta {
      margin-bottom: 0.8rem;
    }
  </style>
</head>
<body>
  <nav class="container-fluid">
    <ul>
      <li><strong>Registro Médico</strong></li>
    </ul>
    <ul>
      <li><a href="#">Inicio</a></li>
    </ul>
  </nav>

  <main class="container">
    <div class="grid">
      <section>
        <hgroup>
          <h2>Formulario de Registro</h2>
          <h3>Complete los siguientes datos del paciente</h3>
        </hgroup>

        <form id="formulario">

          <fieldset>
            <legend>Identificación</legend>

            <label for="ID_paciente">Identificador del paciente (código o DNI)</label>
            <input type="number" id="ID_paciente" name="ID_paciente" />

            <label for="Fecha_consulta">Fecha de la consulta</label>
            <input type="date" id="Fecha_consulta" name="Fecha_consulta" />

          </fieldset>

          <fieldset>
            <legend>Vivienda</legend>

            <label for="Agua_potable">¿Tiene acceso a agua potable?</label>
            <select id="Agua_potable" name="Agua_potable">
              <option value="">-- Seleccione --</option>
              <option value="1">Sí</option>
              <option value="2">No</option>
              <option value="3">No sabe</option>
            </select>

            <label for="Cloaca">¿Tiene acceso a red de cloacas/saneamiento?</label>
            <select id="Cloaca" name="Cloaca">
              <option value="">-- Seleccione --</option>
              <option value="1">Sí</option>
              <option value="2">No</option>
              <option value="3">No sabe</option>
            </select>

          </fieldset>

          <fieldset>
            <legend>Sociodemográficos</legend>

            <label for="Edad">Edad del paciente</label>
            <input type="number" id="Edad" name="Edad" />

            <label for="Sexo_registrado">¿Cuál es su sexo registrado en el DNI?</label>
            <select id="Sexo_registrado" name="Sexo_registrado">
              <option value="">-- Seleccione --</option>
              <option value="1">Varón</option>
              <option value="2">Mujer</option>
              <option value="3">No binario</option>
              <option value="4">Prefiere no responder</option>
            </select>

            <label for="Estado_civil">¿Cuál es su situación conyugal actual?</label>
            <select id="Estado_civil" name="Estado_civil">
              <option value="">-- Seleccione --</option>
              <option value="1">Soltero/a</option>
              <option value="2">En pareja</option>
              <option value="3">Separado/divorciado</option>
              <option value="4">Viudo/a</option>
            </select>

            <label for="Nivel_educativo">¿Cuál es el nivel educativo más alto que alcanzó?</label>
            <select id="Nivel_educativo" name="Nivel_educativo">
              <option value="">-- Seleccione --</option>
              <option value="1">Sin instrucción</option>
              <option value="2">Primaria incompleta</option>
              <option value="3">Primaria completa</option>
              <option value="4">Secundaria incompleta</option>
              <option value="5">Secundaria completa</option>
              <option value="6">Terciaria/Universitaria incompleta</option>
              <option value="7">Terciaria/Universitaria completa</option>
            </select>

            <label for="Cobertura_salud">¿Tiene alguna cobertura de salud (obra social, prepaga, etc.)?</label>
            <select id="Cobertura_salud" name="Cobertura_salud">
              <option value="">-- Seleccione --</option>
              <option value="1">Sí</option>
              <option value="2">No</option>
              <option value="3">No sabe</option>
            </select>

            <label for="Situacion_laboral">¿Cuál es su situación laboral actual?</label>
            <select id="Situacion_laboral" name="Situacion_laboral">
              <option value="">-- Seleccione --</option>
              <option value="1">Trabaja</option>
              <option value="2">No trabaja pero busca trabajo</option>
              <option value="3">No trabaja ni busca trabajo</option>
            </select>

          </fieldset>

          <fieldset>
            <legend>Conductas: Tabaquismo</legend>

            <label for="Fuma_actualmente">
              ¿Actualmente fuma algún producto de tabaco ((cigarrillos fabrica...arrillo armado, cigarrillo con capsula, cigarrillo electronico)?
            </label>
            <select id="Fuma_actualmente" name="Fuma_actualmente">
              <option value="">-- Seleccione --</option>
              <option value="1">Sí</option>
              <option value="2">No</option>
            </select>

            <label for="Fuma_producto">
              De corresponder, que producto fuma?
            </label>
            <select id="Fuma_producto" name="Fuma_producto">
              <option value="">-- Seleccione --</option>
              <option value="1">Cigarrillo fabricado</option>
              <option value="2">Cigarrillo armado</option>
              <option value="3">cigarrillo con capsula</option>
              <option value="4">cigarrillo electronico o vapeo</option>
              <option value="5">tabaco calentado</option>
              <option value="6">bolsa de nicotina</option>
              <option value="7">otro</option>
            </select>

            <label for="Frecuencia_fumador">
              ¿Fuma diariamente o solo ocasionalmente?
            </label>
            <select id="Frecuencia_fumador" name="Frecuencia_fumador">
              <option value="">-- Seleccione --</option>
              <option value="1">Diariamente</option>
              <option value="2">Ocasionalmente</option>
              <option value="3">No aplica</option>
            </select>

            <label for="Edad_inicio_tabaco">
              ¿A qué edad comenzó a fumar con regularidad?
            </label>
            <input type="number" id="Edad_inicio_tabaco" name="Edad_inicio_tabaco" />

            <label for="Intento_dejar_tabaco">
              ¿Ha intentado dejar de fumar en los últimos 12 meses?
            </label>
            <select id="Intento_dejar_tabaco" name="Intento_dejar_tabaco">
              <option value="">-- Seleccione --</option>
              <option value="1">Sí</option>
              <option value="2">No</option>
            </select>

          </fieldset>

          <fieldset>
            <legend>Conductas: Alcohol</legend>

            <label for="Frecuencia_alcohol">
              ¿Con qué frecuencia consume bebidas alcohólicas?
            </label>
            <select id="Frecuencia_alcohol" name="Frecuencia_alcohol">
              <option value="">-- Seleccione --</option>
              <option value="1">Nunca</option>
              <option value="2">1 vez al mes o menos</option>
              <option value="3">2–4 veces al mes</option>
              <option value="4">2–3 veces por semana</option>
              <option value="5">4 o más veces por semana</option>
            </select>

            <label for="Cantidad_alcohol">
              Cuando toma, ¿cuántas bebidas alcohólicas consume en un día típico?
            </label>
            <select id="Cantidad_alcohol" name="Cantidad_alcohol">
              <option value="">-- Seleccione --</option>
              <option value="1">1 o 2</option>
              <option value="2">3 o 4</option>
              <option value="3">5 o 6</option>
              <option value="4">7 a 9</option>
              <option value="5">10 o más</option>
            </select>

            <label for="Exceso_ocasion">
              ¿Con qué frecuencia toma 6 o más bebidas en una sola ocasión?
            </label>
            <select id="Exceso_ocasion" name="Exceso_ocasion">
              <option value="">-- Seleccione --</option>
              <option value="1">Nunca</option>
              <option value="2">Menos de una vez al mes</option>
              <option value="3">Mensualmente</option>
              <option value="4">Semanalmente</option>
              <option value="5">A diario o casi a diario</option>
            </select>

          </fieldset>

          <fieldset>
            <legend>Conductas: Actividad física</legend>

            <label for="Actividad150min">
              ¿En las últimas 2 semanas realizó actividad física moderada o intensa por al menos 150 minutos semanales?
            </label>
            <select id="Actividad150min" name="Actividad150min">
              <option value="">-- Seleccione --</option>
              <option value="1">Sí</option>
              <option value="2">No</option>
            </select>

            <label for="Motivo_actividad">
              ¿Cuál es el motivo principal por el que la realiza o no la realiza?
            </label>
            <select id="Motivo_actividad" name="Motivo_actividad">
              <option value="">-- Seleccione --</option>
              <option value="1">Salud</option>
              <option value="2">Trabajo</option>
              <option value="3">Recreación</option>
              <option value="4">Falta de tiempo</option>
              <option value="5">Problemas físicos</option>
              <option value="6">No le interesa</option>
            </select>

          </fieldset>

          <fieldset>
            <legend>Biomédico</legend>

            <label for="Diagnostico_diabetes">
              ¿Tiene diagnóstico previo de diabetes (incluye diabetes gestacional)?
            </label>
            <select id="Diagnostico_diabetes" name="Diagnostico_diabetes">
              <option value="">-- Seleccione --</option>
              <option value="1">Sí</option>
              <option value="2">No</option>
              <option value="3">No sabe</option>
            </select>

            <label for="Tratamiento_diabetes">
              ¿Recibe tratamiento actualmente por diabetes?
            </label>
            <select id="Tratamiento_diabetes" name="Tratamiento_diabetes">
              <option value="">-- Seleccione --</option>
              <option value="1">Sí</option>
              <option value="2">No</option>
              <option value="3">No sabe</option>
            </select>

            <label for="Tipo_tratamiento_diabetes">
              ¿Qué tipo de tratamiento utiliza para la diabetes?
            </label>
            <select id="Tipo_tratamiento_diabetes" name="Tipo_tratamiento_diabetes">
              <option value="">-- Seleccione --</option>
              <option value="1">Dieta</option>
              <option value="2">ADO</option>
              <option value="3">Insulina</option>
              <option value="4">Otro</option>
              <option value="5">No aplica</option>
            </select>

            <label for="Hemoglobina_glicosilada">
              ¿Cuál es el valor más reciente de hemoglobina glicosilada?
            </label>
            <input type="number" id="Hemoglobina_glicosilada" name="Hemoglobina_glicosilada" />

            <label for="Diagnostico_dislipidemia">
              ¿Tiene diagnóstico conocido de dislipidemia?
            </label>
            <select id="Diagnostico_dislipidemia" name="Diagnostico_dislipidemia">
              <option value="">-- Seleccione --</option>
              <option value="1">Sí</option>
              <option value="2">No</option>
              <option value="3">No sabe</option>
            </select>

            <label for="Colesterol_total">
              Colesterol total (valor de laboratorio más reciente)
            </label>
            <input type="number" id="Colesterol_total" name="Colesterol_total" />

            <label for="HDL">
              Colesterol HDL (valor más reciente)
            </label>
            <input type="number" id="HDL" name="HDL" />

            <label for="LDL">
              Colesterol LDL (valor más reciente)
            </label>
            <input type="number" id="LDL" name="LDL" />

            <label for="Trigliceridos">
              Triglicéridos (valor más reciente)
            </label>
            <input type="number" id="Trigliceridos" name="Trigliceridos" />

            <label for="Diagnostico_HTA">
              ¿Tiene diagnóstico previo de hipertensión arterial?
            </label>
            <select id="Diagnostico_HTA" name="Diagnostico_HTA">
              <option value="">-- Seleccione --</option>
              <option value="1">Sí</option>
              <option value="2">No</option>
              <option value="3">No sabe</option>
            </select>

            <label for="Tratamiento_HTA">
              ¿Recibe tratamiento actualmente por hipertensión arterial?
            </label>
            <select id="Tratamiento_HTA" name="Tratamiento_HTA">
              <option value="">-- Seleccione --</option>
              <option value="1">Sí</option>
              <option value="2">No</option>
              <option value="3">No sabe</option>
            </select>

            <label for="Tipo_tratamiento_HTA">
              ¿Qué tipo de tratamiento utiliza para la hipertensión?
            </label>
            <select id="Tipo_tratamiento_HTA" name="Tipo_tratamiento_HTA">
              <option value="">-- Seleccione --</option>
              <option value="1">IECA</option>
              <option value="2">ARA II</option>
              <option value="3">Betabloqueantes</option>
              <option value="4">Diuréticos</option>
              <option value="5">Otros</option>
              <option value="6">No aplica</option>
            </select>

            <label for="Adherencia_tratamiento_HTA">
              ¿Toma la medicación según lo indicado por su médico?
            </label>
            <select id="Adherencia_tratamiento_HTA" name="Adherencia_tratamiento_HTA">
              <option value="">-- Seleccione --</option>
              <option value="1">Siempre</option>
              <option value="2">A veces</option>
              <option value="3">Rara vez</option>
              <option value="4">No toma medicación</option>
            </select>

            <label for="Hipertension">
              Valor de tension arterial en consulta
            </label>
            <input type="text" id="Hipertension" name="Hipertension" />

            <label for="Peso">
              Peso del paciente (medido en kg)
            </label>
            <input type="number" id="Peso" name="Peso" step="0.1" />

            <label for="Talla">
              Talla del paciente (medida en cm)
            </label>
            <input type="number" id="Talla" name="Talla" step="0.1" />

            <label for="IMC">
              Índice de masa corporal (IMC = peso(kg) / altura(m²))
            </label>
            <input type="number" id="IMC" name="IMC" step="0.1" readonly />

          </fieldset>

          <fieldset>
            <legend>Salud mental</legend>

            <label for="PHQ2_item1">
              En las últimas 2 semanas, ¿tuvo poco interés o placer en hacer las cosas?
            </label>
            <select id="PHQ2_item1" name="PHQ2_item1">
              <option value="">-- Seleccione --</option>
              <option value="0">Nunca</option>
              <option value="1">Varios días</option>
              <option value="2">Más de la mitad de los días</option>
              <option value="3">Casi todos los días</option>
            </select>

            <label for="PHQ2_item2">
              En las últimas 2 semanas, ¿se ha sentido decaído, deprimido o sin esperanzas?
            </label>
            <select id="PHQ2_item2" name="PHQ2_item2">
              <option value="">-- Seleccione --</option>
              <option value="0">Nunca</option>
              <option value="1">Varios días</option>
              <option value="2">Más de la mitad de los días</option>
              <option value="3">Casi todos los días</option>
            </select>

            <label for="GAD2_item1">
              En las últimas 2 semanas, ¿se sintió nervioso, ansioso o al límite?
            </label>
            <select id="GAD2_item1" name="GAD2_item1">
              <option value="">-- Seleccione --</option>
              <option value="0">Nunca</option>
              <option value="1">Varios días</option>
              <option value="2">Más de la mitad de los días</option>
              <option value="3">Casi todos los días</option>
            </select>

            <label for="GAD2_item2">
              En las últimas 2 semanas, ¿no pudo dejar de preocuparse o controlar la preocupación?
            </label>
            <select id="GAD2_item2" name="GAD2_item2">
              <option value="">-- Seleccione --</option>
              <option value="0">Nunca</option>
              <option value="1">Varios días</option>
              <option value="2">Más de la mitad de los días</option>
              <option value="3">Casi todos los días</option>
            </select>

          </fieldset>

          <fieldset>
            <legend>Salud general</legend>

            <label for="Transito">
              ¿En los últimos 12 meses, ha estado involucrado en un accidente de tránsito?
            </label>
            <select id="Transito" name="Transito">
              <option value="">-- Seleccione --</option>
              <option value="0">Si, como conductor</option>
              <option value="1">Si, como pasajero</option>
              <option value="2">Si, como peatón</option>
              <option value="3">No</option>
            </select>

            <label for="Cantidad_medicamentos">
              ¿Cuántos medicamentos toma habitualmente?
            </label>
            <input type="number" id="Cantidad_medicamentos" name="Cantidad_medicamentos" />

            <label for="Polifarmacia">
              ¿Toma 5 o más medicamentos habitualmente?
            </label>
            <select id="Polifarmacia" name="Polifarmacia">
              <option value="">-- Seleccione --</option>
              <option value="1">Sí</option>
              <option value="2">No</option>
            </select>

          </fieldset>

          <fieldset>
            <legend>Prevención</legend>

            <label for="Vacunacion_dobleBacteriana">
              ¿Recibió alguna dosis de vacuna doble bacteriana (contra difteria y tétanos) en los últimos 10 años?
            </label>
            <select id="Vacunacion_dobleBacteriana" name="Vacunacion_dobleBacteriana">
              <option value="">-- Seleccione --</option>
              <option value="1">Sí</option>
              <option value="2">No</option>
              <option value="3">No sabe</option>
            </select>

            <label for="Vacunacion_antigripal">
              ¿Recibió la vacuna antigripal en la última campaña anual (últimos 12 meses)?
            </label>
            <select id="Vacunacion_antigripal" name="Vacunacion_antigripal">
              <option value="">-- Seleccione --</option>
              <option value="1">Sí</option>
              <option value="2">No</option>
              <option value="3">No sabe</option>
              <option value="4">No corresponde</option>
            </select>

            <label for="Vacunacion_neumococo">
              ¿Recibió alguna vacuna contra el neumococo (Prevenar 13, Pneumovax 23 o esquema nuevo con conjugada 20)?
            </label>
            <select id="Vacunacion_neumococo" name="Vacunacion_neumococo">
              <option value="">-- Seleccione --</option>
              <option value="1">Sí, 1 dosis</option>
              <option value="2">Sí, 2 dosis</option>
              <option value="3">Sí, dosis única nuevo esquema</option>
              <option value="4">No</option>
              <option value="5">No Sabe</option>
              <option value="6">No corresponde</option>
            </select>

            <label for="Mamografia">
              ¿Se realizó una mamografía en los últimos 2 años?
            </label>
            <select id="Mamografia" name="Mamografia">
              <option value="">-- Seleccione --</option>
              <option value="1">Sí</option>
              <option value="2">No</option>
              <option value="3">No corresponde</option>
            </select>

            <label for="Papanicolau">
              ¿Se realizó un PAP en los últimos 3 años?
            </label>
            <select id="Papanicolau" name="Papanicolau">
              <option value="">-- Seleccione --</option>
              <option value="1">Sí</option>
              <option value="2">No</option>
              <option value="3">No corresponde</option>
            </select>

            <label for="Cribado_colorrectal">
              ¿Se realizó algún estudio de detección de cáncer colorrectal (FOBT, colonoscopía)?
            </label>
            <select id="Cribado_colorrectal" name="Cribado_colorrectal">
              <option value="">-- Seleccione --</option>
              <option value="1">Sí</option>
              <option value="2">No</option>
              <option value="3">No corresponde</option>
            </select>

          </fieldset>

          <button type="submit" id="botonEnviar">Enviar</button>
          <button type="button" id="nuevoRegistro" style="display:none;">Nuevo registro</button>
        </form>

        <div id="resultado" class="resultado"></div>
      </section>
    </div>
  </main>

  <footer class="container">
    <small><a href="#">Política de privacidad</a> • <a href="#">Términos de uso</a></small>
  </footer>

  <script>
  const form = document.getElementById("formulario");
  const resultado = document.getElementById("resultado");
  const botonEnviar = document.getElementById("botonEnviar");
  const nuevoRegistro = document.getElementById("nuevoRegistro");

  // Referencias para cálculo automático de IMC
  const pesoInput = document.getElementById("Peso");
  const tallaInput = document.getElementById("Talla");
  const imcInput   = document.getElementById("IMC");

  function actualizarIMC() {
    const peso = parseFloat(pesoInput ? pesoInput.value : "");
    const tallaCm = parseFloat(tallaInput ? tallaInput.value : "");

    if (!isNaN(peso) && peso > 0 && !isNaN(tallaCm) && tallaCm > 0) {
      const tallaM = tallaCm / 100;
      const imc = peso / (tallaM * tallaM);
      if (imcInput) {
        imcInput.value = imc.toFixed(1); // 1 decimal
      }
    } else {
      if (imcInput) {
        imcInput.value = "";
      }
    }
  }

  if (pesoInput && tallaInput && imcInput) {
    pesoInput.addEventListener("input", actualizarIMC);
    tallaInput.addEventListener("input", actualizarIMC);
  }

  form.addEventListener("submit", function (e) {
    e.preventDefault();

    // Aseguramos que el IMC esté actualizado justo antes de enviar
    if (pesoInput && tallaInput && imcInput) {
      actualizarIMC();
    }

    const data = {
      // Identificación
      ID_paciente: document.getElementById("ID_paciente").value,
      Fecha_consulta: document.getElementById("Fecha_consulta").value,

      // Vivienda
      Agua_potable: document.getElementById("Agua_potable").value,
      Cloaca: document.getElementById("Cloaca").value,

      // Sociodemográficos
      Edad: document.getElementById("Edad").value,
      Sexo_registrado: document.getElementById("Sexo_registrado").value,
      Estado_civil: document.getElementById("Estado_civil").value,
      Nivel_educativo: document.getElementById("Nivel_educativo").value,
      Cobertura_salud: document.getElementById("Cobertura_salud").value,
      Situacion_laboral: document.getElementById("Situacion_laboral").value,

      // Conductas: Tabaquismo
      Fuma_actualmente: document.getElementById("Fuma_actualmente").value,
      Fuma_producto: document.getElementById("Fuma_producto").value,
      Frecuencia_fumador: document.getElementById("Frecuencia_fumador").value,
      Edad_inicio_tabaco: document.getElementById("Edad_inicio_tabaco").value,
      Intento_dejar_tabaco: document.getElementById("Intento_dejar_tabaco").value,

      // Conductas: Alcohol
      Frecuencia_alcohol: document.getElementById("Frecuencia_alcohol").value,
      Cantidad_alcohol: document.getElementById("Cantidad_alcohol").value,
      Exceso_ocasion: document.getElementById("Exceso_ocasion").value,

      // Conductas: Actividad física
      Actividad150min: document.getElementById("Actividad150min").value,
      Motivo_actividad: document.getElementById("Motivo_actividad").value,

      // Biomédico
      Diagnostico_diabetes: document.getElementById("Diagnostico_diabetes").value,
      Tratamiento_diabetes: document.getElementById("Tratamiento_diabetes").value,
      Tipo_tratamiento_diabetes: document.getElementById("Tipo_tratamiento_diabetes").value,
      Hemoglobina_glicosilada: document.getElementById("Hemoglobina_glicosilada").value,
      Diagnostico_dislipidemia: document.getElementById("Diagnostico_dislipidemia").value,
      Colesterol_total: document.getElementById("Colesterol_total").value,
      HDL: document.getElementById("HDL").value,
      LDL: document.getElementById("LDL").value,
      Trigliceridos: document.getElementById("Trigliceridos").value,
      Diagnostico_HTA: document.getElementById("Diagnostico_HTA").value,
      Tratamiento_HTA: document.getElementById("Tratamiento_HTA").value,
      Tipo_tratamiento_HTA: document.getElementById("Tipo_tratamiento_HTA").value,
      Adherencia_tratamiento_HTA: document.getElementById("Adherencia_tratamiento_HTA").value,
      Hipertension: document.getElementById("Hipertension").value,
      Peso: document.getElementById("Peso").value,
      Talla: document.getElementById("Talla").value,
      IMC: document.getElementById("IMC").value,

      // Salud mental
      PHQ2_item1: document.getElementById("PHQ2_item1").value,
      PHQ2_item2: document.getElementById("PHQ2_item2").value,
      GAD2_item1: document.getElementById("GAD2_item1").value,
      GAD2_item2: document.getElementById("GAD2_item2").value,

      // Salud general
      Transito: document.getElementById("Transito").value,
      Cantidad_medicamentos: document.getElementById("Cantidad_medicamentos").value,
      Polifarmacia: document.getElementById("Polifarmacia").value,

      // Prevención
      Vacunacion_dobleBacteriana: document.getElementById("Vacunacion_dobleBacteriana").value,
      Vacunacion_antigripal: document.getElementById("Vacunacion_antigripal").value,
      Vacunacion_neumococo: document.getElementById("Vacunacion_neumococo").value,
      Mamografia: document.getElementById("Mamografia").value,
      Papanicolau: document.getElementById("Papanicolau").value,
      Cribado_colorrectal: document.getElementById("Cribado_colorrectal").value
    };

    resultado.innerText = "Datos enviados correctamente.";

    botonEnviar.innerText = "¡Enviado!";
    botonEnviar.disabled = true;
    nuevoRegistro.style.display = "inline-block";

    fetch("https://script.google.com/macros/s/AKfycbwkVU5zbuVRW8AOh8N2KxZ__su_mFQLHZ7nXMYUBuY5_TVIayMdDlsLcVdvLR3AVm-PvQ/exec", {
      method: "POST",
      mode: "no-cors",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    });
  });

  nuevoRegistro.addEventListener("click", function () {
    form.reset();
    if (imcInput) imcInput.value = "";
    resultado.innerText = "";
    botonEnviar.disabled = false;
    botonEnviar.innerText = "Enviar";
    nuevoRegistro.style.display = "none";
  });
</script>
</body>
</html>